version: '3.4'
services:
    vpn:
        image: bubuntux/nordvpn
        cap_add:
            - net_admin
        env_file:
            - .env # make sure it contains USER and PASS
        networks:
            - default
        devices:
            - '/dev/net/tun'
        tmpfs:
            - /tmp
        restart: unless-stopped
        stdin_open: true
        tty: true
    foursquare:
        build: ./foursquare
        volumes: 
            - data:/foursquare/output
        command: python main.py
    fundanl:
        build: ./fundanl
        links:
            - postgres
        command: python main.py
    pararius:
        build: ./pararius
        links:
            - postgres
        network_mode: "service:vpn"
        #command: python main.py
    postgres:
        image: mdillon/postgis:latest
        env_file:
            - .env # make sure it contains POSTGRES_USER, POSTGRES_DB and POSTGRES_PASSWORD
        ports:
            - '5432:5432'
        volumes:
            - postgres_data:/var/lib/postgresql/data
        restart: always
    data:
        image: busybox:latest
        volumes:
            - data:/data
volumes:
    data: 
        external: true
        name: scrape_data
    postgres_data: 
        external: true
        name: postgres_data
networks:
    default: